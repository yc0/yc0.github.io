<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Design a configuration management system | My journey</title><meta name=keywords content="system design,amazon,onsite"><meta name=description content="Configuration management system
Design a configuration management system

User should be able to add configuration
User should be able to delete configuration
User should be able to search for configuration
User should be able to subscribe to Configuration So that any updates in configuration will gets notfied to user

Clarify
We want to design a system to persist configurations that can be used by other systems. Configurations will be managed through an internal portal and will be editable only by the user who created them but can be read by any system through a RESTful API. In addition to CRUD (creation, read, updates and deletions) an user can search for configurations and can subscribe to them to receive notifications every time there&rsquo;s a change."><meta name=author content="Nelson"><link rel=canonical href=https://yc0.github.io/posts/design-a-configuration-management-system/><link crossorigin=anonymous href=/assets/css/stylesheet.a090830a421002426baafbd314e38f149d77b4c48a12ee9312700d770b27fb26.css integrity="sha256-oJCDCkIQAkJrqvvTFOOPFJ13tMSKEu6TEnANdwsn+yY=" rel="preload stylesheet" as=style><link rel=icon href=https://yc0.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://yc0.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://yc0.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://yc0.github.io/apple-touch-icon.png><link rel=mask-icon href=https://yc0.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://yc0.github.io/posts/design-a-configuration-management-system/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://yc0.github.io/posts/design-a-configuration-management-system/"><meta property="og:site_name" content="My journey"><meta property="og:title" content="Design a configuration management system"><meta property="og:description" content="Configuration management system Design a configuration management system
User should be able to add configuration User should be able to delete configuration User should be able to search for configuration User should be able to subscribe to Configuration So that any updates in configuration will gets notfied to user Clarify We want to design a system to persist configurations that can be used by other systems. Configurations will be managed through an internal portal and will be editable only by the user who created them but can be read by any system through a RESTful API. In addition to CRUD (creation, read, updates and deletions) an user can search for configurations and can subscribe to them to receive notifications every time there’s a change."><meta property="og:locale" content="zh-tw"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-10-22T16:40:02+00:00"><meta property="article:modified_time" content="2025-10-25T10:47:02+08:00"><meta property="article:tag" content="System Design"><meta property="article:tag" content="Amazon"><meta property="article:tag" content="Onsite"><meta name=twitter:card content="summary"><meta name=twitter:title content="Design a configuration management system"><meta name=twitter:description content="Configuration management system
Design a configuration management system

User should be able to add configuration
User should be able to delete configuration
User should be able to search for configuration
User should be able to subscribe to Configuration So that any updates in configuration will gets notfied to user

Clarify
We want to design a system to persist configurations that can be used by other systems. Configurations will be managed through an internal portal and will be editable only by the user who created them but can be read by any system through a RESTful API. In addition to CRUD (creation, read, updates and deletions) an user can search for configurations and can subscribe to them to receive notifications every time there&rsquo;s a change."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://yc0.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Design a configuration management system","item":"https://yc0.github.io/posts/design-a-configuration-management-system/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Design a configuration management system","name":"Design a configuration management system","description":"Configuration management system Design a configuration management system\nUser should be able to add configuration User should be able to delete configuration User should be able to search for configuration User should be able to subscribe to Configuration So that any updates in configuration will gets notfied to user Clarify We want to design a system to persist configurations that can be used by other systems. Configurations will be managed through an internal portal and will be editable only by the user who created them but can be read by any system through a RESTful API. In addition to CRUD (creation, read, updates and deletions) an user can search for configurations and can subscribe to them to receive notifications every time there\u0026rsquo;s a change.\n","keywords":["system design","amazon","onsite"],"articleBody":"Configuration management system Design a configuration management system\nUser should be able to add configuration User should be able to delete configuration User should be able to search for configuration User should be able to subscribe to Configuration So that any updates in configuration will gets notfied to user Clarify We want to design a system to persist configurations that can be used by other systems. Configurations will be managed through an internal portal and will be editable only by the user who created them but can be read by any system through a RESTful API. In addition to CRUD (creation, read, updates and deletions) an user can search for configurations and can subscribe to them to receive notifications every time there’s a change.\nThis is how I’d go about it (since I don’t have an interviewer to ask questions to, these numbers are made up):\nAssumptions Let’s say we have 500M total users and 50M daily active users There are 1M new configurations created every day on average We get 100M reads of the configurations every day on average Updates are infrequent but they happen: 10k a day on average Deletions are even more infrequent: 5k a day on average Each active user performs 2 searches a day on average 5k subscriptions every day, 0.5k unsubscriptions a day on average Configurations are JSON files that are 1kb in size on average Following the CAP theorem, we can argue that we are interested in an AP system (highly available, partitioned and eventually consistent). With this data, I’d do some back-of-the-envelope math:\nTraffic: Calculate the read TPS and write TPS. Bandwidth: download and upload bandwidth necessary to serve the content Memory: how much memory we are going to need to store 5 and 10 years of configurations * (see below for this) Cache: following the 80/20 rule, calculate how much memory we need to store 20% of daily configurations * (see below for this) To do number 3 and 4, we should sketch the models:\nConfiguration Table:\nConfigurationID ConfigurationName OwnerID ConfigurationURI CreationTimestamp We should estimate the length in bytes of the configuration ID to be able to hold 10 years of IDs. Same for ownerID. Now that we’ve done some math, we probably found out the following:\nThe system is VERY read heavy: Probably a good approach would be to have master write DBs where the changes are propagated to the slave read DBs. Cache will benefit us immensely. Talk about eviction strategies. The TPS will help us figure out how many web servers we need. The memory will probably tell us that we need sharding. Discuss here sharding strategies and No SQL vs SQL databases. Quickly sketch the APIs of the system and their parameters. At least we need the following APIs:\nCreateConfiguration UpdateConfiguration DeleteConfiguration ReadConfiguration SearchConfigurations SubscribeToConfiguration UnsubscribeFromConfiguration After this, draw a HIGH LEVEL diagram (without scaling, load balancing, redundancy, cache etc.) to trace a request for each API:\n|-----\u003e IndexService --------v User --\u003e Web Server --\u003e ConfigurationService --\u003e Database |-----\u003e Cloud Storage After that, we can move on to a detailed design:\nUser --\u003e LoadBalancer --\u003e [WebServer1, WebServer2, ...] --\u003e Load Balancer --\u003e [ConfigurationService1, ConfigurationService2,...] --\u003e Cache --\u003e MasterDatabases --\u003e SlaveDatabases At least Cover the following Load balancing and mention a couple of LB algorithms What we’re storing in the cache What happens when Load Balancers die and how do you detect it Redundancy: how we can guarantee that we wont lose any configurations What happens when there’s a spike of reads because it’s Black Friday on Amazon What happens if a Master Database dies What happens if a slave database dies What happens if the cache dies Do we need a CDN? How can we prevent users from storing highly sensitive data in there? Like Credit Card numbers. What happens if a datacenter goes down? Can we recover from that? How? Can we compress the configurations? How much space is that going to save? What’s the impact in latency when reading a new configuration? How can we throttle a user that wrote a buggy script and is creating configurations like crazy (and will consume all IDs)? What metrics are you going to monitor? Where do you store the logs? How often do you rotate them? What alarming are you going to put in place? ","wordCount":"717","inLanguage":"en","datePublished":"2019-10-22T16:40:02Z","dateModified":"2025-10-25T10:47:02+08:00","author":{"@type":"Person","name":"Nelson"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://yc0.github.io/posts/design-a-configuration-management-system/"},"publisher":{"@type":"Organization","name":"My journey","logo":{"@type":"ImageObject","url":"https://yc0.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://yc0.github.io/ accesskey=h title="My journey (Alt + H)">My journey</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://yc0.github.io/posts/ title="All Posts"><span>All Posts</span></a></li><li><a href=https://yc0.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://yc0.github.io/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://yc0.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://yc0.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Design a configuration management system</h1><div class=post-meta><span title='2019-10-22 16:40:02 +0000 UTC'>October 22, 2019</span>&nbsp;·&nbsp;<span>4 min</span>&nbsp;·&nbsp;<span>Nelson</span></div></header><div class=post-content><h2 id=configuration-management-system>Configuration management system<a hidden class=anchor aria-hidden=true href=#configuration-management-system>#</a></h2><p>Design a configuration management system</p><ul><li>User should be able to add configuration</li><li>User should be able to delete configuration</li><li>User should be able to search for configuration</li><li>User should be able to subscribe to Configuration So that any updates in configuration will gets notfied to user</li></ul><h3 id=clarify>Clarify<a hidden class=anchor aria-hidden=true href=#clarify>#</a></h3><p>We want to design a system to persist configurations that can be used by other systems. Configurations will be managed through an internal portal and will be editable only by the user who created them but can be read by any system through a RESTful API. In addition to CRUD (creation, read, updates and deletions) an user can search for configurations and can subscribe to them to receive notifications every time there&rsquo;s a change.</p><p>This is how I&rsquo;d go about it (since I don&rsquo;t have an interviewer to ask questions to, these numbers are made up):</p><h3 id=assumptions>Assumptions<a hidden class=anchor aria-hidden=true href=#assumptions>#</a></h3><ul><li>Let&rsquo;s say we have 500M total users and 50M daily active users</li><li>There are 1M new configurations created every day on average</li><li>We get 100M reads of the configurations every day on average</li><li>Updates are infrequent but they happen: 10k a day on average</li><li>Deletions are even more infrequent: 5k a day on average</li><li>Each active user performs 2 searches a day on average</li><li>5k subscriptions every day, 0.5k unsubscriptions a day on average</li><li>Configurations are JSON files that are 1kb in size on average</li><li>Following the CAP theorem, we can argue that we are interested in an AP system (highly available, partitioned and eventually consistent).</li></ul><p>With this data, I&rsquo;d do some back-of-the-envelope math:</p><ul><li>Traffic: Calculate the read TPS and write TPS.</li><li>Bandwidth: download and upload bandwidth necessary to serve the content</li><li>Memory: how much memory we are going to need to store 5 and 10 years of configurations * (see below for this)</li><li>Cache: following the 80/20 rule, calculate how much memory we need to store 20% of daily configurations * (see below for this)</li></ul><p>To do number 3 and 4, we should sketch the models:</p><p><code>Configuration Table:</code></p><ul><li>ConfigurationID</li><li>ConfigurationName</li><li>OwnerID</li><li>ConfigurationURI</li><li>CreationTimestamp</li></ul><p>We should estimate the length in bytes of the configuration ID to be able to hold 10 years of IDs. Same for ownerID.
Now that we&rsquo;ve done some math, we probably found out the following:</p><ol><li>The system is VERY read heavy:<ul><li>Probably a good approach would be to have master write DBs where the changes are propagated to the slave read DBs.</li><li>Cache will benefit us immensely. Talk about eviction strategies.</li></ul></li><li>The TPS will help us figure out how many web servers we need.</li><li>The memory will probably tell us that we need sharding. Discuss here sharding strategies and No SQL vs SQL databases.</li></ol><p>Quickly sketch the APIs of the system and their parameters. At least we need the following APIs:</p><ul><li>CreateConfiguration</li><li>UpdateConfiguration</li><li>DeleteConfiguration</li><li>ReadConfiguration</li><li>SearchConfigurations</li><li>SubscribeToConfiguration</li><li>UnsubscribeFromConfiguration</li></ul><p>After this, draw a HIGH LEVEL diagram (without scaling, load balancing, redundancy, cache etc.) to trace a request for each API:</p><pre tabindex=0><code>                     |-----&gt; IndexService --------v
User --&gt; Web Server --&gt; ConfigurationService --&gt; Database
                     |-----&gt; Cloud Storage
</code></pre><p>After that, we can move on to a detailed design:</p><pre tabindex=0><code>User --&gt; LoadBalancer --&gt; [WebServer1, WebServer2, ...] --&gt; Load Balancer --&gt; [ConfigurationService1, ConfigurationService2,...] --&gt; Cache --&gt; MasterDatabases --&gt; SlaveDatabases
</code></pre><h3 id=at-least-cover-the-following>At least Cover the following<a hidden class=anchor aria-hidden=true href=#at-least-cover-the-following>#</a></h3><ol><li>Load balancing and mention a couple of LB algorithms</li><li>What we&rsquo;re storing in the cache</li><li>What happens when Load Balancers die and how do you detect it</li><li>Redundancy: how we can guarantee that we wont lose any configurations</li><li>What happens when there&rsquo;s a spike of reads because it&rsquo;s Black Friday on Amazon</li><li>What happens if a Master Database dies</li><li>What happens if a slave database dies</li><li>What happens if the cache dies</li><li>Do we need a CDN?</li><li>How can we prevent users from storing highly sensitive data in there? Like Credit Card numbers.</li><li>What happens if a datacenter goes down? Can we recover from that? How?</li><li>Can we compress the configurations? How much space is that going to save? What&rsquo;s the impact in latency when reading a new configuration?</li><li>How can we throttle a user that wrote a buggy script and is creating configurations like crazy (and will consume all IDs)?</li><li>What metrics are you going to monitor?</li><li>Where do you store the logs? How often do you rotate them?</li><li>What alarming are you going to put in place?</li></ol></div><footer class=post-footer><ul class=post-tags><li><a href=https://yc0.github.io/tags/system-design/>System Design</a></li><li><a href=https://yc0.github.io/tags/amazon/>Amazon</a></li><li><a href=https://yc0.github.io/tags/onsite/>Onsite</a></li></ul><nav class=paginav><a class=prev href=https://yc0.github.io/posts/design-a-vending-machine/><span class=title>« Prev</span><br><span>Design a Vending Machine</span>
</a><a class=next href=https://yc0.github.io/posts/system-design-overview/><span class=title>Next »</span><br><span>System Design Overview</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://yc0.github.io/>My journey</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>